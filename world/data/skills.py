SKILLS = {
    # Awareness Skills
    "Concentration": {
        "group": "Awareness",
        "stat": "WILL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Conseal/Reveal Object": {
        "group": "Awareness",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Lip Reading": {
        "group": "Awareness",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Perception": {
        "group": "Awareness",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Tracking": {
        "group": "Awareness",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },

    # Body Skills
    "Athletics": {
        "group": "Body",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Contortionist": {
        "group": "Body",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Dance": {
        "group": "Body",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Endurance": {
        "group": "Body",
        "stat": "WILL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Resist Torture/Drugs": {
        "group": "Body",
        "stat": "WILL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Stealth": {
        "group": "Body",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },

    # Control Skills
    "Drive Land Vehicle": {
        "group": "Control",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Pilot Air Vehicle": {
        "group": "Control",
        "stat": "REF",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "Pilot Sea Vehicle": {
        "group": "Control",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Riding": {
        "group": "Control",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },

    # Education Skills
    "Local Expert": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": True,
        "specialties": []
    },
    "Animal Handling": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Bureaucracy": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Business": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Composition": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Criminology": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Cryptography": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Deduction": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Education": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Gamble": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Language": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": True,
        "specialties": []
    },
    "Library Search": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Science": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": True,
        "specialties": []
    },
    "Tactics": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Wilderness Survival": {
        "group": "Education",
        "stat": "INT",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },

    # Fighting Skills
    "Brawling": {
        "group": "Fighting",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Evasion": {
        "group": "Fighting",
        "stat": "DEX",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Martial Arts": {
        "group": "Fighting",
        "stat": "DEX",
        "multiplier": 2,
        "instanced": True,
        "specialties": []
    },
    "Melee Weapon": {
        "group": "Fighting",
        "stat": "DEX",
        "multiplier": 2,
        "instanced": True,
        "specialties": []
    },
    "Acting": {
        "group": "Performance",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Play Instrument": {
        "group": "Performance",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": True,
        "specialties": []
    },
    "Archery": {
        "group": "Ranged",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Autofire": {
        "group": "Ranged",
        "stat": "REF",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "Handgun": {
        "group": "Ranged",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Heavy Weapons": {
        "group": "Ranged",
        "stat": "REF",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "Shoulder Arms": {
        "group": "Ranged",
        "stat": "REF",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    # Social Skills
    "Bribery": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Conversation": {
        "group": "Social",
        "stat": "EMP",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Human Perception": {
        "group": "Social",
        "stat": "EMP",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Interrogation": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Persuasion": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Personal Grooming": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Streetwise": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Trading": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Wardrobe & Style": {
        "group": "Social",
        "stat": "COOL",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    # Technique Skills
    "Air Vehicle Tech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Basic Tech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Cybertech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Demolitions": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "Electronics/Security Tech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "First Aid": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Forgery": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Land Vehicle Tech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Paint/Draw/Sculpt": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Paramedic": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 2,
        "instanced": False,
        "specialties": []
    },
    "Photography/Film": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Pick Lock": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Pick Pocket": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Sea Vehicle Tech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
    "Weaponstech": {
        "group": "Technique",
        "stat": "TECH",
        "multiplier": 1,
        "instanced": False,
        "specialties": []
    },
}

skill_matrix = {
    "Rockerboy": {
        "Athletics": 2,
        "Brawling": 6,
        "Concentration": 2,
        "Conversation": 2,
        "Education": 2,
        "Evasion": 6,
        "First Aid": 6,
        "Human Perception": 6,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 4,
        "Perception": 2,
        "Persuasion": 6,
        "Stealth": 2,
        "Composition": 6,
        "Handgun": 6,
        "Melee Weapon": 6,
        "Personal Grooming": 4,
        "Play Instrument (choose 1)": 6,
        "Streetwise": 6,
        "Wardrobe & Style": 4
    },
    "Solo": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 2,
        "Education": 2,
        "Evasion": 6,
        "First Aid": 6,
        "Human Perception": 2,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 6,
        "Persuasion": 2,
        "Stealth": 2,
        "Autofire": 6,
        "Handgun": 6,
        "Interrogation": 6,
        "Melee Weapon": 6,
        "Resist Torture/Drugs": 6,
        "Shoulder Arms": 6,
        "Tactics": 6
    },
    "Netrunner": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 2,
        "Education": 6,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 2,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 2,
        "Persuasion": 2,
        "Stealth": 6,
        "Basic Tech": 6,
        "Conceal/Reveal Object": 6,
        "Cryptography": 6,
        "Cybertech": 6,
        "Electronics/Security Tech": 6,
        "Handgun": 6,
        "Library Search": 6
    },
    "Tech": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 2,
        "Education": 6,
        "Evasion": 6,
        "First Aid": 6,
        "Human Perception": 2,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 2,
        "Persuasion": 2,
        "Stealth": 2,
        "Basic Tech": 6,
        "Cybertech": 6,
        "Electronics/Security Tech": 6,
        "Land Vehicle Tech": 6,
        "Shoulder Arms": 6,
        "Science (choose 1)": 6,
        "Weaponstech": 6
    },
    "Medtech": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 6,
        "Education": 6,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 6,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 4,
        "Perception": 2,
        "Persuasion": 2,
        "Stealth": 2,
        "Basic Tech": 6,
        "Cybertech": 4,
        "Deduction": 6,
        "Paramedic": 6,
        "Resist Torture/Drugs": 4,
        "Science (choose 1)": 6,
        "Shoulder Arms": 6
    },
    "Media": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 6,
        "Education": 2,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 6,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 6,
        "Perception": 6,
        "Persuasion": 6,
        "Stealth": 2,
        "Bribery": 6,
        "Composition": 6,
        "Deduction": 6,
        "Handgun": 6,
        "Library Search": 4,
        "Lip Reading": 4,
        "Photography/Film": 4
    },
    "Lawman": {
        "Athletics": 2,
        "Brawling": 6,
        "Concentration": 2,
        "Conversation": 6,
        "Education": 2,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 2,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 2,
        "Persuasion": 2,
        "Stealth": 2,
        "Autofire": 6,
        "Criminology": 6,
        "Deduction": 6,
        "Handgun": 6,
        "Interrogation": 6,
        "Shoulder Arms": 6,
        "Tracking": 6
    },
    "Exec": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 6,
        "Education": 6,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 6,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 2,
        "Persuasion": 6,
        "Stealth": 2,
        "Accounting": 6,
        "Bureaucracy": 6,
        "Business": 6,
        "Deduction": 6,
        "Handgun": 6,
        "Lip Reading": 6,
        "Personal Grooming": 4
    },
    "Fixer": {
        "Athletics": 2,
        "Brawling": 2,
        "Concentration": 2,
        "Conversation": 6,
        "Education": 2,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 6,
        "Language (Streetslang)": 4,
        "Local Expert (Your Home)": 6,
        "Perception": 2,
        "Persuasion": 4,
        "Stealth": 2,
        "Bribery": 6,
        "Business": 6,
        "Forgery": 6,
        "Handgun": 6,
        "Pick Lock": 4,
        "Streetwise": 6,
        "Trading": 6
    },
    "Nomad": {
        "Athletics": 2,
        "Brawling": 6,
        "Concentration": 2,
        "Conversation": 2,
        "Education": 6,
        "Evasion": 6,
        "First Aid": 2,
        "Human Perception": 2,
        "Language (Streetslang)": 2,
        "Local Expert (Your Home)": 2,
        "Perception": 4,
        "Persuasion": 2,
        "Stealth": 6,
        "Animal Handling": 6,
        "Drive Land Vehicle": 6,
        "Handgun": 6,
        "Melee Weapon": 6,
        "Tracking": 6,
        "Trading": 6,
        "Wilderness Survival": 6
    }
}

# Skills that require a 'specialty' to be taken when it's selected.
INSTANCED_SKILLS = ["language", "play instrument", "local expert", "science"]


class SkillHandler():
    """
    The SkillsHandler is responsible for handling all aspects of character skills.
    """

    def __init__(self):
        self.skills = {}

    def add(self, name="", base=0):
        "Add a new skill to the handler."

        self.skills[name] = {"base": base, "temp": base, "effects": []}

    def assign(self, name="", base=0):
        "Assign a new base value to an established skill."

        if self.skills[name]:
            self.skills[name]["base"] = base

    def remove(self, skill):
        "Remove a skill from a character."
        if self.skills[skill]:
            del self.skills[skill]

    def effect(self, skill, eff_name, mod=0, desc="", remove=False):
        "Set a new effect on a stat, or remove an existing effect."
        if remove:
            for effect in self.skills[skill]["effects"]:
                if effect["name"].lower() == eff_name.lower():
                    self.skills[skill]["effects"].remove(effect)
        else:
            self.skills[skill]["effects"].append(
                {"name": eff_name, "mod": mod, "desc": desc})

    def current(self, skill):
        """
        Get the current level of a skill, taking any effects into account.
        """
        mod = 0
        for effect in self.skills[skill]["effects"]:
            mod += effect["mod"]

        if self.skills[skill]["temp"]:
            return self.skills[skill]["temp"] + mod
        else:
            return self.skills[skill]["base"] + mod
